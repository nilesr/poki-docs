.TH BOUNCER 1
.SH NAME
bouncer \- determine which stratum the command being invoked should be executed in, and delegate it to \fBstrat(1)\fR
.SH SYNOPSIS
.I command
.RI [ arguments ...]
.SH DESCRIPTION
This document describes the \fBbouncer\fR command, used to delegate execution of a file in a filesystem generated by \fBcrossfs(1)\fR to it's local stratum using \fBstrat(1)\fR. The \fBbouncer\fR command is part of the Bedrock Linux userland ⟨https://bedrocklinux.org⟩.
.P
The \fBbouncer\fR program reads the extended filesystem attributes of the file that it was invoked as and looks at \fIuser.bedrock.stratum\fR or \fIuser.bedrock.localpath\fR (set by \fBcrossfs(1)\fR) to determine what command should be executed, and in which stratum, then executes it in the correct stratum using \fBstrat(1)\fR
.SH EXIT STATUS
.B bouncer
.R returns the exit status of the command if it was able to execute. If it could not find the command in the specified stratum, the command was not executable, or it was invoked via a file that does not have the \fIuser.bedrock.stratum\fR or \fIuser.bedrock.localpath\fR extended filesystem attributes, it exits with the status 1.
.SH FILES
.IR /bedrock/etc/strata.conf " \- holds configuration for the strata that"
.B bouncer
.R can execute commands in
.P
.I /bedrock/run/enabled_strata/
.R Holds root-owned non-world-writeable files that \fBbouncer\fR uses to determine if commands are runnable in the given strata
.SH NOTES
.B bouncer
was introduced in Bedrock Linux 0.7.0 Poki. Previously, \fBread(2)\fRing a file in a \fBcrossfs(1)\fR filesystem (known as \fBbrp(1)\fR at the time) resulted in a script that looked like this
.PP
.nf
.RS
#!/bedrock/libexec/busybox sh
exec /bedrock/bin/brc ${stratum} ${command} "$@"
.RE
.fi
.PP
(\fBbrc(1)\fR was later renamed to \fBstrat(1)\fR).
The use of this sort of script loses \fIargv[0]\fR, and these scripts were found to be unsuitable in situations which leverage \fIargv[0]\fR.
.BR bouncer " was created to fulfill this role while retaining"
.I argv[0]
.SH BUGS
Please report any bugs you find by opening an issue at \fIhttps://github.com/bedrocklinux/bedrocklinux\-userland\fR or talking to \fIparadigm\fR in \fI#bedrock\fR on \fIirc.freenode.com\fR.
.SH EXAMPLE
.B bouncer
automatically executes the command the user requested, so you never call \fBbouncer\fR directly, but instead invoke it from a filesystem generated by \fBcrossfs(1)\fR. On a typical Bedrock Linux system, the only filesystem is \fI/bedrdock/brpath\fR.
.P
For example, if you had \fBcowsay(6)\fR installed in \fIartful\fR but not \fIarch\fR, and you are currently running commands in \fIarch\fR, you can have \fBbouncer\fR automatically determine which strata has \fBcowsay(6)\fR and execute the command in that strata:
.PP
.nf
.RS
$ \fBbrl current\fR
arch
$ \fBbrl which cowsay\fR
artful (implicit)
$ \fBwhich cowsay\fR
/bedrock/brpath/bin/cowsay
$ \fB/bedrock/brpath/bin/cowsay Hello, world\fR
 ______________
< Hello, world >
 --------------
        \\   ^__^
         \\  (oo)\\_______
            (__)\\       )\\/\\
                ||----w |
                ||     ||

.RE
.fi
.PP
.SH SEE ALSO
.B brl(1), crossfs(1)
